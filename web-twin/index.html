<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pendulum Digital Twin</title>
  </head>
  <body>
    <div id="app">
      <div id="pendulum-container" class="disconnected">
        <div id="loading-spinner" class="loading-spinner">
          <div class="spinner"></div>
          <span>Waiting for connection...</span>
        </div>
      </div>
      <div id="info-panel">
        <h1>Pendulum Digital Twin</h1>
        <div id="status">Connecting...</div>
        
        <div id="mode-display">
          Mode: <span id="current-mode">idle</span>
        </div>
        
        <div id="stats">
          <div class="stat-box">
            <span class="stat-label">Angle</span>
            <span id="angle-value" class="stat-value">0.0</span>¬∞
          </div>
          <div class="stat-box">
            <span class="stat-label">Velocity</span>
            <span id="velocity-value" class="stat-value">0.0</span>¬∞/s
          </div>
          <div class="stat-box">
            <span class="stat-label">Motor</span>
            <span id="motor-value" class="stat-value">0</span> st/s
          </div>
        </div>
        
        <div id="position-display">
          <div class="position-header">
            <span class="stat-label">Cart Position</span>
            <span id="position-value">0</span>
          </div>
          <div class="position-track">
            <div class="limit-indicator left" id="limit-left"></div>
            <div class="position-marker" id="position-marker"></div>
            <div class="limit-indicator right" id="limit-right"></div>
          </div>
          <div class="position-labels">
            <span>‚Üê Left Limit</span>
            <span>Right Limit ‚Üí</span>
          </div>
          <div class="limit-positions">
            <span id="limit-left-pos">--</span>
            <span id="limit-right-pos">--</span>
          </div>
        </div>

        <div id="controls">
          <h2>Controls</h2>
          
          <div class="control-row">
            <button id="btn-left" class="control-btn hold-btn" data-mode-start="manual_left" data-mode-stop="idle">
              ‚Üê Left
            </button>
            <button id="btn-right" class="control-btn hold-btn" data-mode-start="manual_right" data-mode-stop="idle">
              Right ‚Üí
            </button>
          </div>
          
          <div class="control-row">
            <button id="btn-oscillate" class="control-btn toggle-btn" data-mode="oscillate">
              ‚Üï Oscillate
            </button>
          </div>
          
          <div class="control-row">
            <button id="btn-swingup" class="control-btn toggle-btn accent" data-mode="swing_up">
              ‚ö° Swing Up
            </button>
          </div>
          
          <div class="control-row">
            <button id="btn-balance" class="control-btn toggle-btn" data-mode="balance">
              ‚öñ Balance
            </button>
            <button id="btn-neat-balance" class="control-btn toggle-btn neat-btn" data-mode="neat_balance">
              üß† NEAT
            </button>
          </div>
          
          <div class="control-row">
            <button id="btn-stop" class="control-btn stop-btn" data-mode="idle">
              ‚èπ Stop
            </button>
            <button id="btn-zero" class="control-btn zero-btn">
              üéØ Zero
            </button>
          </div>
          
          <div class="control-row">
            <button id="btn-home" class="control-btn home-btn">
              üè† Home
            </button>
          </div>
          
          <div class="control-row">
            <button id="btn-upload" class="control-btn upload-btn">
              üì§ Upload Arduino Code
            </button>
          </div>
          <div id="upload-status"></div>
        </div>

        <div id="config">
          <h2>Configuration</h2>
          
          <div class="config-section">
            <h3>Manual Mode</h3>
            <div class="slider-row">
              <label>Speed</label>
              <input type="range" id="cfg-manual-speed" min="0" max="10000" value="1000" data-cfg="manual_speed">
              <span class="slider-value" id="val-manual-speed">1000</span>
            </div>
          </div>
          
          <div class="config-section">
            <h3>Oscillate Mode</h3>
            <div class="slider-row">
              <label>Speed</label>
              <input type="range" id="cfg-osc-speed" min="500" max="20000" value="3000" data-cfg="oscillate_speed">
              <span class="slider-value" id="val-osc-speed">3000</span>
            </div>
            <div class="slider-row">
              <label>Period (s)</label>
              <input type="range" id="cfg-osc-period" min="0.5" max="5" step="0.1" value="2" data-cfg="oscillate_period">
              <span class="slider-value" id="val-osc-period">2.0</span>
            </div>
          </div>
          
          <div class="config-section">
            <h3>Swing-Up Mode</h3>
            <div class="slider-row">
              <label>Max Speed</label>
              <input type="range" id="cfg-swing-speed" min="1000" max="30000" value="10000" data-cfg="swingup_max_speed">
              <span class="slider-value" id="val-swing-speed">10000</span>
            </div>
            <div class="slider-row">
              <label>Kp Gain</label>
              <input type="range" id="cfg-swing-kp" min="1000" max="20000" value="8000" data-cfg="swingup_kp">
              <span class="slider-value" id="val-swing-kp">8000</span>
            </div>
          </div>
          
          <div class="config-section">
            <h3>Balance Mode</h3>
            <div class="slider-row">
              <label>Kp</label>
              <input type="range" id="cfg-bal-kp" min="100" max="2000" value="500" data-cfg="balance_kp">
              <span class="slider-value" id="val-bal-kp">500</span>
            </div>
            <div class="slider-row">
              <label>Kd</label>
              <input type="range" id="cfg-bal-kd" min="10" max="200" value="50" data-cfg="balance_kd">
              <span class="slider-value" id="val-bal-kd">50</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
